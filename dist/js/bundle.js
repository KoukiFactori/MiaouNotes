(()=>{"use strict";function t(t,e){for(var n=0,a=!1,o=0;o<t.length;o++)t[o]>=0&&(n+=t[o]*e[o],a=!0);var r=-1;return a&&-1!=n&&(r=n/e.reduce((function(t,e){return t+e}),0)),r}function e(e,n){var a=[],o=[];return e.forEach((function(t){t.matiere==n&&(a.push(t.note),o.push(t.coefficient))})),t(a,o)}function n(n){var a=[],o=[],r="";return n.forEach((function(t){r!=t.matiere&&e(n,t.matiere)>=0&&(a.push(e(n,t.matiere)),o.push(1),r=t.matiere)})),t(a,o)}function a(t,e,n){void 0===n&&(n=!1);var a=document.createElement("tr");e&&a.classList.add("moyenne"),n&&a.classList.add("new-note");var o=document.createElement("td");o.textContent=t.matiere,a.appendChild(o);var r=document.createElement("td");r.textContent=t.evaluation,a.appendChild(r);var d=document.createElement("td");d.classList.add("hide"),e||(d.textContent=t.date),a.appendChild(d);var i=document.createElement("td");i.classList.add("hide"),e||(i.textContent=t.commentaire),a.appendChild(i);var l=document.createElement("td");if(t.note>=10)l.textContent=t.note.toPrecision(4).toString();else if(-1==t.note)l.textContent="";else{var c=document.createElement("span");c.classList.add("badge","bg-warning"),t.note<0?c.textContent=t.note.toString():c.textContent=t.note.toPrecision(4).toString(),l.appendChild(c)}a.appendChild(l);var u=document.createElement("td");u.classList.add("hide"),e||(u.textContent=t.coefficient.toString()),a.appendChild(u);var m=document.createElement("td");if(!e){var s=document.createElement("button");s.classList.add("btn","btn-info","btn-outline","btn-square","btn-xs"),s.setAttribute("data-controller","modal"),s.setAttribute("data-modal-modal-title-value","Détails d'une note"),s.setAttribute("data-modal-modal-url-value","/fr/application/etudiant/note/details/"+t.id),s.setAttribute("data-action","click->modal#openModal"),s.setAttribute("data-bs-toggle","tooltip"),s.setAttribute("data-bs-placement","bottom"),s.setAttribute("data-bs-original-title","Détails");var h=document.createElement("i");h.classList.add("fas","fa-info"),s.appendChild(h),m.appendChild(s)}return a.appendChild(m),a}chrome.storage.sync.get(["notesAlreadyKnow"],(function(t){var o=t.notesAlreadyKnow||[],r=document.querySelector("#mainContent > div.row > div:nth-child(5) > div > div > table"),d=function(t){var e=t.querySelector("tbody"),n=[];return e.querySelectorAll("tr").forEach((function(t){var e=t.querySelector("td:nth-child(7) > button").getAttribute("data-modal-modal-url-value").split("/"),a={id:parseInt(e[e.length-1]),matiere:t.querySelector("td:nth-child(1)").textContent,evaluation:t.querySelector("td:nth-child(2)").textContent,date:t.querySelector("td:nth-child(3)").textContent,commentaire:t.querySelector("td:nth-child(4)").textContent,note:parseFloat(t.querySelector("td:nth-child(5)").textContent),coefficient:parseFloat(t.querySelector("td:nth-child(6)").textContent)};n.push(a)})),n.sort((function(t,e){return t.matiere>e.matiere?1:-1})),n}(r);console.log(o);var i,l=function(t,o){var r=document.createElement("table");r.classList.add("table","table-border","table-striped");var d=document.createElement("thead");r.appendChild(d);var i=document.createElement("tr");d.appendChild(i);var l=document.createElement("th");l.textContent="Matière",i.appendChild(l);var c=document.createElement("th");c.textContent="Evaluation",i.appendChild(c);var u=document.createElement("th");u.textContent="date",i.appendChild(u);var m=document.createElement("th");m.textContent="Commentaire de l'évaluation",i.appendChild(m);var s=document.createElement("th");s.textContent="Note",i.appendChild(s);var h=document.createElement("th");h.textContent="coefficient",i.appendChild(h);var p=document.createElement("th");p.textContent="Informations",i.appendChild(p);var v=document.createElement("tbody");r.appendChild(v),t.forEach((function(n,r){var d=a(n,!1,!o.includes(n.id));if(v.appendChild(d),r==t.length-1||t[r+1].matiere!=n.matiere){var i=a({matiere:n.matiere,evaluation:"Moyenne",note:e(t,n.matiere)},!0);v.appendChild(i)}}));var C=a({matiere:"",evaluation:"Moyenne Générale",note:n(t)},!0);return v.appendChild(C),r}(d,o);r.replaceWith(l),((i=document.createElement("button")).innerHTML="Sauvegarder les notes connues",i.classList.add("btn","btn-sm","btn-primary"),i.id="save-notes-btn",document.querySelector("#mainContent > div.row > div:nth-child(5) > div > h4").appendChild(i),i).addEventListener("click",(function(){var t=[];d.forEach((function(e){t.push(e.id)})),chrome.storage.sync.set({notesAlreadyKnow:t},(function(){console.log("rechargement de la page"),location.reload()}))}))}))})();